var this_js_script=$("script[src*=faceted_navigation]"),hide_promo_unit=this_js_script.attr("data-hide_promo_unit");jQuery.fn.reverse=[].reverse;function update_slider_labels(e,c,f){"undefined"!=typeof f&&(min_amount=parseFloat(e.toString()).toFixed(2).replace(/\.00/,""),max_amount=parseFloat(c.toString()).toFixed(2).replace(/\.00/,""),$("#slider_min_amount_"+f).text(min_amount),$("#slider_max_amount_"+f).text(max_amount))}function update_slider_tags(f,c,h){if("undefined"!=typeof h&&"undefined"!=typeof selected_tags){var g=tag_groups.indexOf(h);$("input[type=hidden][name^=tags_id]").each(function(){-1!=tag_ids[g].indexOf($(this).val())&&$(this).remove()});for(i=0;i<tags[g].length;i++){tags[g][i]>=f&&tags[g][i]<=c&&$("#ajax_filters").append('<input type="hidden" value="'+tag_ids[g][i]+'" name="tags_id[]">')}FacetedNavigation.prototype.load_new_hash(!0)}}function instant_slider(g,f,j,h,k){h=h||f;k=k||j;$("#tag_slider_"+g).slider({range:!0,min:f,max:j,values:[h,k],step:1,create:function(a,c){update_slider_labels(h,k,g)},slide:function(a,c){update_slider_labels(c.values[0],c.values[1],g)},change:function(a,c){update_slider_tags(c.values[0],c.values[1],g)}})}function slider_tags(){tags=[];tag_ids=[];tag_groups=[];selected_tags=[];$("a[id^='tags_id'].filter_slider").each(function(){var f=$(this).attr("id").match(/\[([0-9]+)\]_([0-9]+)/g);if("undefined"!==typeof f[0]){tag_group_text=f[0].replace(/\[/g,"").replace(/\]/g,"");var f=tag_group_text.split("_")[0],h=tag_group_text.split("_")[1],g=$.trim($(this).text()),j=tag_groups.indexOf(f);-1==j&&(tag_groups[tag_groups.length]=f,j=tag_groups.indexOf(f));"undefined"==typeof tag_ids[j]&&(tag_ids[j]=[]);tag_ids[j][tag_ids[j].length]=h;"undefined"==typeof tags[j]&&(tags[j]=[]);tags[j][tags[j].length]=parseInt(g);$(this).hasClass("active_filter")&&("undefined"==typeof selected_tags[j]&&(selected_tags[j]=[]),selected_tags[j][selected_tags[j].length]=g)}});var b=tags.map(function(c){return c.slice()});if("undefined"!=typeof tag_groups&&0<tag_groups.length){for($(".slider_ul").hide(),i=0;i<tag_groups.length;i++){group_high=b[i].sort()[b[i].length-1],group_low=b[i].sort()[0],step_amount=10,50>=group_high?step_amount=1:200>=group_high&&(step_amount=5),group_selected_low=group_low,group_selected_high=group_high,"undefined"!=typeof selected_tags[i]&&0<selected_tags[i].length&&(group_selected_high=selected_tags[i].sort()[selected_tags[i].length-1],group_selected_low=selected_tags[i].sort()[0]),html='<li class="tag_slider"><div id="tag_slider_'+tag_groups[i]+'"></div></li><li class="tag_slider_amounts"><div class="slider_min_amount" id="slider_min_amount_'+tag_groups[i]+'">'+group_low+'</div><div class="slider_max_amount" id="slider_max_amount_'+tag_groups[i]+'">'+group_high+'</div><div class="clear"></div></li>',$(".slider_div_"+tag_groups[i]).append(html),instant_slider(tag_groups[i],parseInt(group_low),parseInt(group_high),parseInt(group_selected_low),parseInt(group_selected_high))}}}function FacetedNavigation(){this.new_state=this.current_state=null;this.ajax_handle_filters=this.ajax_handle_products="";this.running_from_history=this.running_from_init=this.history_callback_setup=this.cancel_history_callback=this.running_products_refresh=this.running_filters_refresh=!1;this.page_url=this.page_title="";this.per_m2_max_price=this.per_m2_min_price=this.max_price=this.min_price=null;var b=this;$(document).ready(function(){b.init();if("function"===typeof startProductListingsInfiniteScroll){var a=setInterval(function(){if(0==$.active){clearInterval(a);var c=b.get_current_hash();0<c.length&&"undefined"!==typeof document.location.origin?document.location.replace(document.location.origin+document.location.pathname+c):0<c.length&&document.location.replace(document.location+c);startProductListingsInfiniteScroll()}},150)}})}FacetedNavigation.prototype.init=function(){var d=document.location.hash;""!=document.location.hash&&(null!=document.location.hash&&"function"!==typeof startProductListingsInfiniteScroll)&&(document.location.hash="");var c=this.update_filters_form();this.current_state=this.create_state("",c.productlistings_ajax_url,c.faceted_navigation_ajax_url,c.faceted_navigation_ajax_post_data);this.page_title=document.title;this.page_url=document.location;0<d.length&&(this.page_url.hash=d);this.running_from_init=!0;this.change_page_url();this.running_from_init=!1;""!=d&&this.load_defined_hash(this.create_state(d,"","",""),!0);this.setup_history_callback();this.setup()};FacetedNavigation.prototype.create_state=function(f,c,h,g){return{hash:f,productlistings_ajax_url:c,faceted_navigation_ajax_url:h,faceted_navigation_ajax_post_data:g}};FacetedNavigation.prototype.setup_history_callback=function(){var b=this;this.history_callback_setup||(this.history_available()?window.onpopstate=function(a){0!=$("#categories").length&&null!=a.state||b.history_callback(a.state);return !0}:window.onhashchange=function(){b.history_callback();return !0},this.history_callback_setup=!0)};FacetedNavigation.prototype.history_available=function(){return history.pushState&&history.replaceState?!0:!1};FacetedNavigation.prototype.setup=function(){this.update_selected_links();this.setup_mobile_filters();this.hide_sublevels();this.hide_criteria_links();this.toggle_filters();this.attach_event_handlers();$(".pagination:not(.infinitescroll)").show();$("#breadcrumb_container").html($("#breadcrumb_hidden").html());$("#dynamic_promo").length&&$("#dynamic_promo").YMslider();try{"function"===typeof this.slider_tags&&this.slider_tags(),slider_tags()}catch(d){}try{"function"===typeof this.setup_custom&&this.setup_custom()}catch(c){}};FacetedNavigation.prototype.history_callback=function(b){this.cancel_history_callback||(this.history_available()&&""!=b||(b=this.create_state(document.location.hash,"","","")),null!=b&&this.load_defined_hash(b,!0))};FacetedNavigation.prototype.get_current_hash=function(){return null!=this.current_state?this.current_state.hash:""};FacetedNavigation.prototype.load_defined_hash=function(e,c){var f=this.update_filters_form(e);this.running_from_history="undefined"===typeof c?!1:!0;this.new_state=e;this.load_content(f)};FacetedNavigation.prototype.load_new_hash=function(d){var c=this.process_filters_form();this.new_state=this.create_state(c.new_hash,c.productlistings_ajax_url,c.faceted_navigation_ajax_url,c.faceted_navigation_ajax_post_data);this.load_content(c,d)};FacetedNavigation.prototype.load_content=function(e,c){this.cancel_history_callback=!0;"undefined"!==typeof c&&$.scrollTo("0px",750);$("#page_number").remove();this.ajax_load_filters(e.faceted_navigation_ajax_url,e.faceted_navigation_ajax_post_data);var f=this;setTimeout(function(){f.ajax_load_products(e.productlistings_ajax_url)},100)};FacetedNavigation.prototype.ajax_load_products=function(d){var c=this;this.running_products_refresh||(this.running_products_refresh=!0,this.before_loading_both(),this.before_loading_products(),"object"===typeof this.ajax_handle_products&&this.ajax_handle_products.abort(),this.ajax_handle_products=$.ajax({type:"GET",url:"/ajax/getProductListings"+d,dataType:"html",success:function(b){null!==b&&($("#middle_column").html(b),$("#ajax_filters_loading").length||$("#middle_column").append('<div id="ajax_filters_loading" class="ajax-loading"></div>'));c.loaded_products=!0;c.after_loading_products();c.after_loading_both()}}),this.running_products_refresh=!1)};FacetedNavigation.prototype.ajax_load_filters=function(f,c){var h=this;if(!this.running_filters_refresh){this.running_filters_refresh=!0;this.current_state=this.new_state;this.new_state=null;var g=[];$(".filter_catalog_navigation_option_values").each(function(){g.push($(this).scrollTop())});this.before_loading_both();this.before_loading_filters();"object"===typeof this.ajax_handle_filters&&this.ajax_handle_filters.abort();this.ajax_handle_filters=$.ajax({type:"POST",url:"/ajax/facetednavigation/"+f,data:c,dataType:"json",success:function(e){$("#catalog_navigation_wrapper").html(e.html);"undefined"!==typeof e.redirect_to&&""!=e.redirect_to&&("object"===typeof h.ajax_handle_products&&h.ajax_handle_products.abort(),document.location=e.redirect_to);"undefined"!==typeof e.page_url&&""!=e.page_url&&(h.page_url=e.page_url);var d=0;$(".filter_catalog_navigation_option_values").each(function(){$(this).scrollTo(g[d]);d++});h.loaded_filters=!0;h.after_loading_filters();h.after_loading_both()}});this.running_filters_refresh=!1}};FacetedNavigation.prototype.before_loading_both=function(){this.show_ajax_loading()};FacetedNavigation.prototype.before_loading_products=function(){try{"function"===typeof this.before_loading_products_custom&&this.before_loading_products_custom()}catch(b){}};FacetedNavigation.prototype.before_loading_filters=function(){try{"function"===typeof stopProductListingsInfiniteScroll&&stopProductListingsInfiniteScroll()}catch(e){}try{"function"===typeof this.before_loading_filters_custom&&this.before_loading_filters_custom()}catch(c){}try{"undefined"!=typeof min_price&&"undefined"!=typeof max_price&&(this.min_price=min_price,this.max_price=max_price,"undefined"!=typeof prices_changed&&(this.prices_changed=prices_changed)),"undefined"!=typeof per_m2_min_price&&"undefined"!=typeof per_m2_max_price&&(this.per_m2_min_price=per_m2_min_price,this.per_m2_max_price=per_m2_max_price)}catch(f){}};FacetedNavigation.prototype.after_loading_products=function(){this.attach_event_handlers();$(".hide_after_ajax").hide();$(".pagination").show();$("#breadcrumb_container").html($("#breadcrumb_hidden").html());$("#dynamic_promo").length&&$("#dynamic_promo").YMslider();hide_promo_unit&&$("#promo_unit_listings_brand_image").hide(400);try{$(".quick_buy_trigger").unbind("click"),initQuickBuy()}catch(B){}try{"function"===typeof initQuickView&&initQuickView()}catch(A){}try{"function"==typeof init_slider&&init_slider()}catch(y){}try{"function"==typeof update_product_preview&&update_product_preview()}catch(w){}try{"function"==typeof fnPostFilterCallback&&fnPostFilterCallback(strJSON)}catch(z){}try{"function"==typeof fnPostFilterHeaderCallback&&fnPostFilterHeaderCallback()}catch(u){}try{"function"==typeof tb_call&&tb_call()}catch(s){}try{"function"==typeof hideAllDetails&&hideAllDetails()}catch(r){}try{"function"==typeof change_category_header&&change_category_header()}catch(t){}try{"function"==typeof init_vs3_tracking_refresh_product_listings&&init_vs3_tracking_refresh_product_listings()}catch(v){}try{"function"===typeof bindSortBy&&bindSortBy()}catch(q){}try{"function"===typeof bindPerPage&&bindPerPage()}catch(o){}$('<div id="product_listings_show" onclick="$(\'#category_description_short\').hide();$(\'#category_description\').show();$(\'#product_listings_show\').hide();$(\'#product_listings_hide\').show();return false;"><a href="#" title="Additional Info">Additional Info</a><div class="product_listings_arrow"></div></div>').appendTo("#category_description_short p:last");$('<div id="product_listings_hide" style="display:none;" onclick="$(\'#category_description\').hide();$(\'#category_description_short\').show();$(\'#product_listings_show\').show();$(\'#product_listings_hide\').hide();return false; "><a href="#"title="Less Info">Less Info</a><div class="product_listings_arrow"></div></div>').appendTo("#category_description p:last");this.page_title=this.get_page_title();try{"function"===typeof this.after_loading_products_custom&&this.after_loading_products_custom()}catch(j){}};FacetedNavigation.prototype.after_loading_filters=function(){this.update_filters_form();this.update_selected_links();this.hide_sublevels();this.hide_criteria_links();this.toggle_filters();this.attach_event_handlers();$(".hide_after_ajax").hide();try{"function"===typeof this.after_loading_filters_custom&&this.after_loading_filters_custom(),"function"===typeof updateFilterTitle&&updateFilterTitle(!0)}catch(h){}try{if(null!=this.min_price&&null!=this.max_price){"undefined"==typeof this.prices_changed||this.prices_changed||(this.min_price=min_price,this.max_price=max_price);$("#slider-range").slider("values",0,parseFloat(this.min_price)).slider("values",1,parseFloat(this.max_price)).slider("option").slide(null,{values:{0:parseFloat(this.min_price),1:parseFloat(this.max_price)}});var f=$("#manual-price-input-min"),l=$("#manual-price-input-max");f.length&&f.val(this.min_price);l.length&&l.val(this.max_price)}null!=this.per_m2_min_price&&null!=this.per_m2_max_price&&$("#per_m2_slider-range").slider("values",0,parseFloat(this.per_m2_min_price)).slider("values",1,parseFloat(this.per_m2_max_price)).slider("option").slide(null,{values:{0:parseFloat(this.per_m2_min_price),1:parseFloat(this.per_m2_max_price)}})}catch(k){}try{"function"===typeof cutFilterListOptions&&cutFilterListOptions()}catch(m){}try{"function"===typeof setupFilterTitleToggle&&setupFilterTitleToggle()}catch(j){}};FacetedNavigation.prototype.after_loading_both=function(){if(this.loaded_filters&&this.loaded_products){this.setup_mobile_filters();this.attach_event_handlers();this.change_page_url();this.hide_ajax_loading();this.loaded_filters=this.loaded_products=this.running_from_init=this.running_from_history=!1;var f=this;setTimeout(function(){f.cancel_history_callback=!1},250);this.check_for_no_results();try{"function"===typeof this.after_loading_both_custom&&this.after_loading_both_custom()}catch(c){}try{"function"===typeof this.slider_tags&&this.slider_tags(),slider_tags()}catch(h){}"function"==typeof fnPostFilterCallback&&fnPostFilterCallback();"function"===typeof startProductListingsInfiniteScroll&&setTimeout(function(){0==$.active&&startProductListingsInfiniteScroll()},150);try{"function"===typeof refreshProductHeight&&setTimeout(refreshProductHeight,150)}catch(g){}}};FacetedNavigation.prototype.hide_sublevels=function(){$("ul.filter_catalog_navigation_option_values_sublevel").hide()};FacetedNavigation.prototype.hide_criteria_links=function(){$("#navigation_criteria_list .your_selection a[href='']").remove()};FacetedNavigation.prototype.toggle_filters=function(){var b=$("#filters_navigation");b.length&&b.hasClass("horizontal_filters")||$(".filter_catalog_navigation").each(function(f,h){var g=$(h);if(0===$("form#filters_to_open input[value='"+g.attr("id").replace("filter_catalog_navigation_wrapper_","").replace("filter_catalog_navigation_option_","").replace(/\[\d+\]/,"")+"']").length){try{toggleFilterVisibility(g)}catch(j){}}})};FacetedNavigation.prototype.update_selected_links=function(){$("form#ajax_filters input").each(function(){var e=$(this).val(),c=$(this).attr("name").replace(/\[/g,"").replace(/\]/g,""),f="";switch(c){case"category_ids":f="categories_id";break;case"manufacturer_id":f="manufacturers";break;default:f=c}switch(f){case"categories_id":case"manufacturers":case"price_band_id":$("#filter_catalog_navigation_link_"+f+"_"+e+" a").addClass("active_filter");break;case"tags_id":case"attribute_value_ids":$(".filter_catalog_navigation_link_"+f+"_"+e+" a").addClass("active_filter")}})};FacetedNavigation.prototype.check_for_no_results=function(){$("#search_results").hasClass("cms_page")||$("#search_results_empty")};FacetedNavigation.prototype.attach_event_handlers=function(){this.event_handlers_criteria_links();this.event_handlers_filter_links();this.event_handlers_page_numbers();this.event_handlers_num_per_page();this.event_handlers_sort_by_dropdown();this.event_handlers_sort_by_text_links()};FacetedNavigation.prototype.event_handlers_criteria_links=function(){var b=this;$("#navigation_criteria_list .your_selection a").unbind("click").bind("click",function(){if(1==b.process_filters_form().criteria_count){return !1}var a="",j=$(this).parent().attr("id").replace("your_selection_","").match(/([^\[]+)\[/g);"undefined"!==typeof j[0]&&(j=j[0].replace(/\[/g,""));var h=$(this).parent().attr("id").replace(j,"").replace("your_selection_","").match(/_[0-9]+/g);"undefined"!==typeof h[0]&&(h=h[0].replace(/_/g,""));if(null==j||null==h){return !1}switch(j){case"categories_id":a="category_ids[]";break;case"manufacturers":a="manufacturer_id[]";break;case"tags_id":a="tags_id[]";break;case"price_band_id":a="price_band_id[]";break;case"attribute_value_ids":a="attribute_value_ids[]"}if("category_ids[]"==a){if(0<$("form#base_criteria input[name='"+a+"'][value='"+h+"']").length&&1==$("form#base_criteria input[name='"+a+"']").length&&1==$("form#ajax_filters input[name='"+a+"']").length){$("form#base_criteria input[name='category_ids[]']").remove(),$("form#ajax_filters input[name='category_ids[]']").remove(),$("form#base_criteria input[name='child_categories[]']").remove(),$("form#ajax_filters input[name='child_categories[]']").remove(),$("form#base_criteria input[name='parent_category_id[]']").each(function(){0!=$(this).val()&&($("form#base_criteria").append('<input type="hidden" name="category_ids[]" value="'+$(this).val()+'" />'),$("form#ajax_filters").append('<input type="hidden" name="category_ids[]" value="'+$(this).val()+'" />'))}),$("form#base_criteria input[name='parent_child_categories[]']").each(function(){$("form#base_criteria").append('<input type="hidden" name="child_categories[]" value="'+$(this).val()+'" />');$("form#ajax_filters").append('<input type="hidden" name="child_categories[]" value="'+$(this).val()+'" />')}),$("form#base_criteria input[name='parent_category_id[]']").remove(),$("form#ajax_filters input[name='parent_category_id[]']").remove(),$("form#base_criteria input[name='parent_child_categories[]']").remove(),$("form#ajax_filters input[name='parent_child_categories[]']").remove()}else{var k=[],f=0;$(".filter_catalog_navigation_link a[name='categories_id_"+h+"'] .filter_catalog_navigation_option_values_sublevel a").each(function(){$(this).attr("name").replace(/_([\-0-9]+)$/g,"");f=$(this).attr("name").replace(j,"").replace(/[^\-0-9]/g,"");k[k.length]=f});if(1<k.length){for(x=0;x<k.length;x++){$("form#ajax_filters input[name='child_categories[]'][value='"+k[x]+"']").remove()}}$("form#ajax_filters input[name='child_categories[]'][value='"+h+"']").remove();$("form#ajax_filters input[name='category_ids[]'][value='"+h+"']").remove();0==$("form#ajax_filters input[name='"+a+"']").length&&($("form#base_criteria input[name='category_ids[]']").each(function(){$("form#ajax_filters").append('<input type="hidden" name="category_ids[]" value="'+$(this).val()+'" />')}),$("form#base_criteria input[name='child_categories[]']").each(function(){$("form#ajax_filters").append('<input type="hidden" name="child_categories[]" value="'+$(this).val()+'" />')}))}}else{"manufacturer_id[]"==a?(0<$("form#base_criteria input[name='"+a+"'][value='"+h+"']").length&&0==$("form#ajax_filters input[name='"+a+"'][value='-"+h+"']").length&&$("form#ajax_filters").append('<input type="hidden" name="'+a+'" value="-'+h+'" />'),$("form#ajax_filters input[name='"+a+"'][value='"+h+"']").remove(),0==$("form#ajax_filters input[name='"+a+"']").length&&0<$("form#ajax_filters input[name='parent_manufacturer_id[]']").length&&($("form#ajax_filters input[name='parent_manufacturer_id[]']").each(function(){$("form#ajax_filters").append('<input type="hidden" name="'+a+'" value="'+$(this).val()+'" />')}),$("form#ajax_filters input[name='parent_manufacturer_id[]']").remove())):-1!=a.indexOf("[]")?(0<$("form#base_criteria input[name='"+a+"'][value='"+h+"']").length&&0==$("form#ajax_filters input[name='"+a+"'][value='-"+h+"']").length&&$("form#ajax_filters").append('<input type="hidden" name="'+a+'" value="-'+h+'" />'),$("form#ajax_filters input[name='"+a+"'][value='"+h+"']").remove()):""!=a&&$("form#ajax_filters input[name='"+a+"']").remove()}$("#ajax_filters_pages").val("1");b.load_new_hash();return !1})};FacetedNavigation.prototype.event_handlers_filter_links=function(){var b=this;$(".filter_catalog_navigation_link a").unbind("click").bind("click",function(){var a="",j=$(this).attr("name").replace(/_([\-0-9]+)$/g,""),h=$(this).attr("name").replace(j,"").replace(/[^\-0-9]/g,"");$(this).addClass("active_filter");switch(j){case"categories_id":a="category_ids[]";break;case"manufacturers":a="manufacturer_id[]";break;case"tags_id":a="tags_id[]";break;case"price_band_id":a="price_band_id[]";break;case"attribute_value_ids":a="attribute_value_ids[]";break;default:"tags_id["==j.substring(0,8)&&(a="tags_id[]"),"attribute_value_ids["==j.substring(0,20)&&(a="attribute_value_ids[]")}if("category_ids[]"==a){var k=[],f=0;$(this).parent().find(".filter_catalog_navigation_option_values_sublevel a").each(function(){$(this).attr("name").replace(/_([\-0-9]+)$/g,"");f=$(this).attr("name").replace(j,"").replace(/[^\-0-9]/g,"");k[k.length]=f});if(0==$("form#ajax_filters input[name='category_ids[]'][value='"+h+"']").length){if(1<k.length){for($("form#base_criteria input[name='category_ids[]']").remove(),$("form#ajax_filters input[name='category_ids[]']").remove(),$("form#base_criteria input[name='child_categories[]']").remove(),$("form#ajax_filters input[name='child_categories[]']").remove(),$("form#base_criteria input[name='parent_category_id[]']").remove(),$("form#ajax_filters input[name='parent_category_id[]']").remove(),$("form#base_criteria input[name='parent_child_categories[]']").remove(),$("form#ajax_filters input[name='parent_child_categories[]']").remove(),$("form#base_criteria").append('<input type="hidden" name="child_categories[]" value="'+h+'" />'),$("form#ajax_filters").append('<input type="hidden" name="child_categories[]" value="'+h+'" />'),$("form#base_criteria").append('<input type="hidden" name="category_ids[]" value="'+h+'" />'),$("form#ajax_filters").append('<input type="hidden" name="category_ids[]" value="'+h+'" />'),x=0;x<k.length;x++){$("form#base_criteria").append('<input type="hidden" name="child_categories[]" value="'+k[x]+'" />'),$("form#ajax_filters").append('<input type="hidden" name="child_categories[]" value="'+k[x]+'" />')}}else{if($("form#base_criteria input[name='category_ids[]']").each(function(){$("form#ajax_filters input[name='category_ids[]'][value='"+$(this).val()+"']").remove()}),$("form#base_criteria input[name='child_categories[]']").each(function(){$("form#ajax_filters input[name='child_categories[]'][value='"+$(this).val()+"']").remove()}),$("form#ajax_filters input[name='category_ids[]']").each(function(){$("form#ajax_filters").append('<input type="hidden" name="child_categories[]" value="'+$(this).val()+'" />')}),$("form#ajax_filters").append('<input type="hidden" name="child_categories[]" value="'+h+'" />'),$("form#ajax_filters").append('<input type="hidden" name="category_ids[]" value="'+h+'" />'),1<k.length){for(x=0;x<k.length;x++){$("form#base_criteria").append('<input type="hidden" name="child_categories[]" value="'+k[x]+'" />'),$("form#ajax_filters").append('<input type="hidden" name="child_categories[]" value="'+k[x]+'" />')}}}}else{return a=("your_selection_"+j+"["+h+"]_"+h).replace(/\[/g,"\\[").replace(/\]/g,"\\]"),""!=a&&$("#"+a+" a").click(),!1}}else{if("manufacturer_id[]"==a){if(k=[],f=0,$(this).parent().find(".filter_catalog_navigation_option_values_sublevel a").each(function(){$(this).attr("name").replace(/_([\-0-9]+)$/g,"");f=$(this).attr("name").replace(j,"").replace(/[^\-0-9]/g,"");k[k.length]=f}),0==$("form#ajax_filters input[name='"+a+"'][value='"+h+"']").length){"undefined"!=typeof k[0]&&1==$("form#ajax_filters input[name='"+a+"']").length&&($("form#ajax_filters input[name='parent_manufacturer_id[]']").remove(),$("form#ajax_filters").append('<input type="hidden" name="parent_manufacturer_id[]" value="'+k[0]+'" />'),$("form#ajax_filters input[name='"+a+"'][value='"+k[0]+"']").remove()),$("form#ajax_filters").append('<input type="hidden" name="'+a+'" value="'+h+'" />'),$("form#ajax_filters input[name='"+a+"'][value='-"+h+"']").remove()}else{return a=("your_selection_"+j+"["+h+"]_"+h).replace(/\[/g,"\\[").replace(/\]/g,"\\]"),""!=a&&$("#"+a+" a").click(),!1}}else{if(-1!=a.indexOf("[]")){if(0==$("form#ajax_filters input[name='"+a+"'][value='"+h+"']").length){$("form#ajax_filters").append('<input type="hidden" name="'+a+'" value="'+h+'" />'),$("form#ajax_filters input[name='"+a+"'][value='-"+h+"']").remove()}else{return a=("your_selection_"+j+"["+h+"]_"+h).replace(/\[/g,"\\[").replace(/\]/g,"\\]"),""!=a&&$("#"+a+" a").click(),!1}}else{""!=a&&$("form#ajax_filters input[name='"+a+"']").val(h)}}}$("#ajax_filters_pages").val("1");b.load_new_hash();return !1})};FacetedNavigation.prototype.event_handlers_page_numbers=function(){var b=this;$(".pagination a").unbind("click").bind("click",function(){var a=b.get_text_from_link($(this));if(a.match("next")||$(this).hasClass("next_page")){a=$("#ajax_filters_pages").val(),a=parseInt(a)+1}else{if(a.match("prev")||$(this).hasClass("prev_page")){a=$("#ajax_filters_pages").val(),a=parseInt(a)-1}}$("#ajax_filters_pages").val(a);b.load_new_hash(!0);return !1})};FacetedNavigation.prototype.event_handlers_num_per_page=function(){var b=this;$("#page_view_options > a, a.view_all, .view_all > a, .view_all_btn, a.num_products_per_page").unbind("click").bind("click",function(){var a=b.get_text_from_link($(this)),a=a.replace(/.*\s([0-9]+|all).*/i,"$1");isNaN(a)&&(a="all");$("#ajax_filters_num_per_page").val(a);$("#ajax_filters_pages").val("1");b.load_new_hash(!1);return !1})};FacetedNavigation.prototype.event_handlers_sort_by_dropdown=function(){var b=this;$("#sort_order").unbind("click").unbind("change").attr("onchange",null).bind("change",function(){var a=$(this).val().replace(/([^0-9]+)/ig,"");$("#ajax_filters_sortby").val(a);$("#ajax_filters_pages").val("1");b.load_new_hash(!0);return !1})};FacetedNavigation.prototype.event_handlers_sort_by_text_links=function(){var b=this;$("#sortby_text_links").find(".sortby_div a").unbind("click").bind("click",function(){var a=$(this).attr("href").replace("?sort=","");$("#ajax_filters_sortby").val(a);$("#ajax_filters_pages").val("1");b.load_new_hash(!0);return !1})};FacetedNavigation.prototype.get_text_from_link=function(d){var c=d.text(),c=c.replace(/^\s+|\s+$/g,"");""==c&&(c=d.attr("title"));c=c.toLowerCase();return c=c.replace(/^\s+|\s+$/g,"")};FacetedNavigation.prototype.get_page_title=function(){try{return"undefined"!=typeof $("#metatitle").val()&&""!=$("#metatitle").val()?$("#metatitle").val():"undefined"!=typeof $("#metatitle").text()&&""!=$("#metatitle").text()?$("#metatitle").text():"undefined"!=typeof $("#wrapper_container h1").first().text()&&""!=$("#wrapper_container h1").first().text()?$("#wrapper_container h1").first().text():$("h1").first().text()}catch(b){}};FacetedNavigation.prototype.change_page_url=function(){this.running_from_history||this.running_from_init?this.running_from_history||this.history_available()&&history.replaceState(this.current_state,this.page_title,this.page_url):this.history_available()?history.pushState(this.current_state,this.page_title,this.page_url):document.location.hash=this.current_state.hash;document.title=this.page_title};FacetedNavigation.prototype.show_ajax_loading=function(){0==$("#ajax_filters_loading").length?$("#middle_column").append('<div id="ajax_filters_loading" class="ajax-loading"></div>'):$("#ajax_filters_loading").show()};FacetedNavigation.prototype.hide_ajax_loading=function(){$("#ajax_filters_loading").hide()};FacetedNavigation.prototype.process_filters_form=function(){return new FiltersForm};FacetedNavigation.prototype.update_filters_form=function(b){"undefined"===typeof b&&(b=this.create_state(this.get_current_hash(),"","",""));return new FiltersForm(!0,b)};function FiltersForm(d,c){this.criteria_count=0;this.new_hash="";this.new_hash_array=[];this.faceted_navigation_ajax_post_data=this.faceted_navigation_ajax_url=this.productlistings_ajax_url="";"undefined"===typeof d?this.process_filters_form():this.update_filters_form(c)}FiltersForm.prototype.update_filters_form=function(h){var f=h.hash;if(""!=h.productlistings_ajax_url&&""!=h.faceted_navigation_ajax_url&&""!=h.faceted_navigation_ajax_post_data){this.new_hash=h.hash,this.productlistings_ajax_url=h.productlistings_ajax_url,this.faceted_navigation_ajax_url=h.faceted_navigation_ajax_url,this.faceted_navigation_ajax_post_data=h.faceted_navigation_ajax_post_data}else{$("form#ajax_filters input").remove();$("form#base_criteria input").clone().appendTo("form#ajax_filters");h=f.replace(/#/,"").split(":");f=!0;for(x=0;x<h.length;x++){var n="",m=h[x].replace(/[\-0-9]/g,""),o=h[x].replace(/[^\-0-9]/g,"");switch(m){case"c":n="category_ids[]";break;case"m":n="manufacturer_id[]";break;case"mp":n="parent_manufacturer_id[]";break;case"t":n="tags_id[]";break;case"b":n="price_band_id[]";break;case"a":n="attribute_value_ids[]";break;case"sort":n="sort";break;case"page":n="page"}if("category_ids[]"==n){var l=[],j=0;$(".filter_catalog_navigation_link a[name='categories_id_"+o+"'] .filter_catalog_navigation_option_values_sublevel a").each(function(){$(this).attr("name").replace(/_([\-0-9]+)$/g,"");j=$(this).attr("name").replace(link_name,"").replace(/[^\-0-9]/g,"");l[l.length]=j});if(1<l.length){if($("form#base_criteria input[name='category_ids[]']").remove(),$("form#ajax_filters input[name='category_ids[]']").remove(),$("form#base_criteria input[name='child_categories[]']").remove(),$("form#ajax_filters input[name='child_categories[]']").remove(),$("form#base_criteria input[name='parent_category_id[]']").remove(),$("form#ajax_filters input[name='parent_category_id[]']").remove(),$("form#base_criteria input[name='parent_child_categories[]']").remove(),$("form#ajax_filters input[name='parent_child_categories[]']").remove(),$("form#base_criteria").append('<input type="hidden" name="parent_category_id[]" value="'+o+'" />'),$("form#ajax_filters").append('<input type="hidden" name="parent_category_id[]" value="'+o+'" />'),$("form#base_criteria").append('<input type="hidden" name="child_categories[]" value="'+o+'" />'),$("form#base_criteria").append('<input type="hidden" name="category_ids[]" value="'+o+'" />'),1<l.length){for(x=0;x<l.length;x++){$("form#base_criteria").append('<input type="hidden" name="child_categories[]" value="'+l[x]+'" />'),$("form#ajax_filters").append('<input type="hidden" name="child_categories[]" value="'+l[x]+'" />')}}}else{f&&($("form#base_criteria input[name='category_ids[]']").each(function(){$("form#ajax_filters input[name='category_ids[]'][value='"+$(this).val()+"']").remove()}),$("form#base_criteria input[name='child_categories[]']").each(function(){$("form#ajax_filters input[name='child_categories[]'][value='"+$(this).val()+"']").remove()}),$("form#base_criteria input[name='parent_category_id[]']").each(function(){$("form#ajax_filters input[name='parent_category_id[]'][value='"+$(this).val()+"']").remove()}),f=!1),$("form#ajax_filters").append('<input type="hidden" name="child_categories[]" value="'+o+'" />'),$("form#ajax_filters").append('<input type="hidden" name="category_ids[]" value="'+o+'" />')}}else{"parent_manufacturer_id[]"==n?($("form#ajax_filters input[name='manufacturer_id[]'][value='"+o+"']").remove(),0>o?$("form#ajax_filters input[name='"+n+"'][value='"+-o+"']").remove():$("form#ajax_filters input[name='"+n+"'][value='"+o+"']").remove(),0==$("form#ajax_filters input[name='"+n+"'][value='"+o+"']").length&&$("form#ajax_filters").append('<input type="hidden" name="'+n+'" value="'+o+'" />')):-1!=n.indexOf("[]")?(0>o?$("form#ajax_filters input[name='"+n+"'][value='"+-o+"']").remove():$("form#ajax_filters input[name='"+n+"'][value='"+o+"']").remove(),0==$("form#ajax_filters input[name='"+n+"'][value='"+o+"']").length&&$("form#ajax_filters").append('<input type="hidden" name="'+n+'" value="'+o+'" />')):""!=n&&$("form#ajax_filters input[name='"+n+"']").val(o)}}this.process_filters_form()}};FiltersForm.prototype.process_filters_form=function(){var h=this;h.criteria_count=0;try{"undefined"!=typeof min_price&&"undefined"!=typeof max_price&&(0==$("form#ajax_filters input[name='min_price']").length?$("form#ajax_filters").append('<input type="hidden" name="min_price" value="'+min_price+'" />'):$("form#ajax_filters input[name='min_price']").val(min_price),0==$("form#ajax_filters input[name='max_price']").length?$("form#ajax_filters").append('<input type="hidden" name="max_price" value="'+max_price+'" />'):$("form#ajax_filters input[name='max_price']").val(max_price)),"undefined"!=typeof per_m2_min_price&&"undefined"!=typeof per_m2_max_price&&(0==$("form#ajax_filters input[name='per_m2_min_price']").length?$("form#ajax_filters").append('<input type="hidden" name="per_m2_min_price" value="'+per_m2_min_price+'" />'):$("form#ajax_filters input[name='per_m2_min_price']").val(per_m2_min_price),0==$("form#ajax_filters input[name='per_m2_max_price']").length?$("form#ajax_filters").append('<input type="hidden" name="per_m2_max_price" value="'+per_m2_max_price+'" />'):$("form#ajax_filters input[name='per_m2_max_price']").val(per_m2_max_price))}catch(f){}var l={},k={};$("form#ajax_filters input").each(function(){var a="",g="",d=$(this).val(),e=$(this).attr("name");switch(e){case"base_criteria[]":g="base_criteria";break;case"child_categories[]":g="categories_id[]";h.criteria_count++;break;case"category_ids[]":a="c";g="parent_category_id[]";0!=d&&h.criteria_count++;break;case"manufacturer_id[]":a="m";g=e;h.criteria_count++;break;case"parent_manufacturer_id[]":a="mp";break;case"tags_id[]":a="t";g=e;h.criteria_count++;break;case"rating[]":g=e;h.criteria_count++;break;case"price_band_id[]":a="b";g=e;h.criteria_count++;break;case"min_price":if("undefined"!=typeof prices_changed&&!prices_changed){break}g=e;h.criteria_count++;break;case"max_price":if("undefined"!=typeof prices_changed&&!prices_changed){break}g=e;h.criteria_count++;break;case"per_m2_min_price":g=e;h.criteria_count++;break;case"per_m2_max_price":g=e;h.criteria_count++;break;case"use_per_m2_prices":g=e;h.criteria_count++;break;case"keywords":g=e;""!=d&&h.criteria_count++;break;case"sale_flag[]":g=e;"78"!=d&&h.criteria_count++;break;case"upcoming_flag[]":g=e;"78"!=d&&h.criteria_count++;break;case"all_upcoming_flag[]":g=e;"78"!=d&&h.criteria_count++;break;case"new_products_flag[]":g=e;"78"!=d&&h.criteria_count++;break;case"buy_list_flag[]":g=e;"78"!=d&&h.criteria_count++;break;case"featured_flag[]":g=e;"78"!=d&&h.criteria_count++;break;case"tradediscounts_trade_discount_id[]":g=e;h.criteria_count++;break;case"sale_ids":g=e;h.criteria_count++;break;case"attribute_value_ids[]":a="a";g=e;h.criteria_count++;break;case"tag_groups_id":g=e;break;case"category_group_id":g=e;break;case"active_flag":g=e;break;case"has_stock_flag":g=e;break;case"base_url":g=e;break;case"page_type":g=e;break;case"page_variant":g=e;"new_products"!=d&&"buy_lists"!=d&&"preview"!=d&&"best_sellers"!=d&&"featured_products"!=d&&"in_stock"!=d&&"pre_orders"!=d&&"trade_prices"!=d||h.criteria_count++;break;case"show":g=e;break;case"sort":a="sort";g=e;break;case"page":1!=d&&(a="page");g=e;break;case"id[]":g="id[]";break;case"bundle_option_ids[]":g=e}$("form#base_criteria input[name='"+e+"']").each(function(){$(this).val()==d&&(a="")});""!=a&&""!=d&&(h.new_hash_array[h.new_hash_array.length]=a+d);""!=g&&(0<=d||isNaN(d))&&("categories_id[]"==g?(k[e]=null!=k[e]?k[e]+"|":"",k[e]+=d):(""!=h.productlistings_ajax_url&&(h.productlistings_ajax_url+="&"),h.productlistings_ajax_url+=g+"="+d));l[e]=null!=l[e]?l[e]+"|":"";l[e]+=d});for(var m in k){""!=h.productlistings_ajax_url&&(h.productlistings_ajax_url+="&"),h.productlistings_ajax_url+=m+"="+k[m]}for(m in l){""!=h.faceted_navigation_ajax_post_data&&(h.faceted_navigation_ajax_post_data+="&"),h.faceted_navigation_ajax_post_data+=m+"="+l[m]}var j={};$("form#base_criteria input").each(function(){null!=j[$(this).attr("name")]?j[$(this).attr("name")]+="|":j[$(this).attr("name")]="";j[$(this).attr("name")]+=$(this).val()});for(m in j){""!=h.faceted_navigation_ajax_url&&(h.faceted_navigation_ajax_url+="&"),h.faceted_navigation_ajax_url+=m+"="+j[m]}h.productlistings_ajax_url="?"+h.productlistings_ajax_url+"&transport=html";h.faceted_navigation_ajax_url="?"+h.faceted_navigation_ajax_url;h.new_hash_array.sort();h.new_hash="#"+h.new_hash_array.join(":")};FacetedNavigation.prototype.mobile_dropdown_click=function(b){b=b.replace(/\[/g,"\\[").replace(/\]/g,"\\]");""!=$("#"+b+" option:selected").val()&&(b=$("#"+b+" option:selected").attr("id"),b="#"+b.replace("_mobileselect","").replace(/\[/g,"\\[").replace(/\]/g,"\\]"),$(".filter_catalog_navigation_link").find(b).last().click())};FacetedNavigation.prototype.mobile_criterialink_click=function(b){b=b.replace("_mobileselect","").replace(/\[/g,"\\[").replace(/\]/g,"\\]");""!=b&&$("#"+b+" a").click()};FacetedNavigation.prototype.setup_mobile_filters=function(){var b=this;0==$("div#mobile_filters div#filter_drop_downs").length?$("div#mobile_filters").prepend($("<div/>").attr("id","filter_drop_downs")):$("div#mobile_filters div#filter_drop_downs").html("");0==$("div#mobile_filters_clear").length?$("div#mobile_filters").parent().prepend($("<div/>").attr("id","mobile_filters_clear")):$("div#mobile_filters_clear").html("");$("ul#navigation_criteria_list").each(function(){$(this).children("li").each(function(){if(0!=$(this).children("a").length){var a=$(this).attr("id"),f=$(this).children("a").first().attr("href"),c=$(this).children("span").first().text(),a=null!=f&&""!=f?$("<a/>").attr("id",a+"_mobileselect").attr("href","").html(c+' <span class="remove_filter_selection">'+vs.lang("product_listings.remove_filter")+"</span>").click(function(){b.mobile_criterialink_click($(this).attr("id"));return !1}):$("<span/>").attr("id",a+"_mobileselect").html(c);$("div#mobile_filters_clear").append($("<p/>").append(a))}})});$("div#mobile_filters #sort_order").unbind("click").unbind("change").attr("onchange",null).bind("change",function(){var a=$(this).val().replace(/([^0-9]+)/ig,"");$("#ajax_filters_sortby").val(a);$("#ajax_filters_pages").val("1");b.load_new_hash(!0);return !1});$("ul.filter_catalog_navigation_option").reverse().each(function(){$(this).children("li").each(function(){var a=$(this).attr("id"),l=$(this).attr("class"),j=$(this).children("span.filter_title").text(),m=vs.lang("product_listings.filter_by");if("product_listings.filter_by"!=m){var j=j.replace(" :","").replace(":",""),h=RegExp("/^"+m.replace("%s","(.+?)")+"$/");j.search(h)||(j=m.replace("%s",j))}if("-float"==a.substr(a.length-6)){return !0}var f=$("<select/>").attr("id",a+"_mobileselect").attr("class",l).change(function(){b.mobile_dropdown_click($(this).attr("id"))});f.append($("<option/>").attr("id",a+"_mobileselect_default").val("").html(j));$(this).find("li").each(function(){$(this).children("a").each(function(){var e=$(this).attr("href"),d=$(this).attr("id"),g=$(this).attr("title");""!=g&&f.append($("<option/>").attr("id",d+"_mobileselect").val(e).html(g))})});1<$(f).children().length&&(a=$("<div/>").attr("class","filter_drop_down").append(f),$("div#mobile_filters div#filter_drop_downs").prepend(a))})})};var FNavigation=new FacetedNavigation;function resetPageInHash(b){}function getProductListingsQuery(){return FNavigation.process_filters_form().productlistings_ajax_url}function refreshProductListings(){return FacetedNavigation.prototype.load_new_hash(!0)}function applyAjaxViewType(b){""!=b&&$.cookie("VSViewType",b,{expires:365,path:"/",domain:window.location.hostname});return FacetedNavigation.prototype.load_new_hash(!0)}function filtersHistoryCallback(b){FNavigation.cancel_history_callback||FNavigation.load_new_hash()};